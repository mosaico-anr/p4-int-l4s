+ set -x
+ '[' 0 -ne 0 ']'
+ '[' -z '' ']'
+ export ENABLE_INT=yes
+ ENABLE_INT=yes
+ FILE=switch-l4s.json
+ [[ 0 == \1 ]]
+ '[' true == '' ']'
+ echo 'No need to compile P4 code'
No need to compile P4 code
+ source environment.sh
++ set -x
++ export IFACE=enp0s8
++ IFACE=enp0s8
++ export REV_IFACE=enp0s9
++ REV_IFACE=enp0s9
++ export MON_IFACE=enp0s10
++ MON_IFACE=enp0s10
++ export SERVER_NET=10.0.1.0/24
++ SERVER_NET=10.0.1.0/24
++ export CLIENT_NET=10.0.0.0/24
++ CLIENT_NET=10.0.0.0/24
++ export SERVER_A=10.0.1.11
++ SERVER_A=10.0.1.11
++ export SERVER_B=10.0.1.12
++ SERVER_B=10.0.1.12
++ export CLIENT_A=10.0.0.11
++ CLIENT_A=10.0.0.11
++ export CLIENT_B=10.0.0.12
++ CLIENT_B=10.0.0.12
++ export CLIENT_A_IFACE=enp0s8
++ CLIENT_A_IFACE=enp0s8
++ export CLIENT_B_IFACE=enp0s8
++ CLIENT_B_IFACE=enp0s8
++ export SERVER_A_IFACE=enp0s8
++ SERVER_A_IFACE=enp0s8
++ export SERVER_B_IFACE=enp0s8
++ SERVER_B_IFACE=enp0s8
++ export MMT_IP=10.0.30.2
++ MMT_IP=10.0.30.2
++ export MMT_IFACE=enp0s8
++ MMT_IFACE=enp0s8
+ mkdir -p log
++ get-mac enp0s8
++ iface=enp0s8
++ cat /sys/class/net/enp0s8/address
+ export IFACE_MAC=08:00:27:55:c7:75
+ IFACE_MAC=08:00:27:55:c7:75
++ get-mac enp0s9
++ iface=enp0s9
++ cat /sys/class/net/enp0s9/address
+ export REV_IFACE_MAC=08:00:27:32:3c:0d
+ REV_IFACE_MAC=08:00:27:32:3c:0d
++ get-mac enp0s10
++ iface=enp0s10
++ cat /sys/class/net/enp0s10/address
+ export MON_IFACE_MAC=08:00:27:ef:9f:28
+ MON_IFACE_MAC=08:00:27:ef:9f:28
++ get-remote-mac 10.0.0.11 enp0s8
++ ip=10.0.0.11
++ iface=enp0s8
++ run-on-host 10.0.0.11 cat /sys/class/net/enp0s8/address
++ '[' 3 -lt 2 ']'
++ hostname=10.0.0.11
++ shift
++ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- cat /sys/class/net/enp0s8/address
+ export CLIENT_A_MAC=08:00:27:fe:18:fc
+ CLIENT_A_MAC=08:00:27:fe:18:fc
++ get-remote-mac 10.0.0.12 enp0s8
++ ip=10.0.0.12
++ iface=enp0s8
++ run-on-host 10.0.0.12 cat /sys/class/net/enp0s8/address
++ '[' 3 -lt 2 ']'
++ hostname=10.0.0.12
++ shift
++ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- cat /sys/class/net/enp0s8/address
+ export CLIENT_B_MAC=08:00:27:72:8a:ae
+ CLIENT_B_MAC=08:00:27:72:8a:ae
++ get-remote-mac 10.0.1.11 enp0s8
++ ip=10.0.1.11
++ iface=enp0s8
++ run-on-host 10.0.1.11 cat /sys/class/net/enp0s8/address
++ '[' 3 -lt 2 ']'
++ hostname=10.0.1.11
++ shift
++ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- cat /sys/class/net/enp0s8/address
+ export SERVER_A_MAC=08:00:27:66:48:02
+ SERVER_A_MAC=08:00:27:66:48:02
++ get-remote-mac 10.0.1.12 enp0s8
++ ip=10.0.1.12
++ iface=enp0s8
++ run-on-host 10.0.1.12 cat /sys/class/net/enp0s8/address
++ '[' 3 -lt 2 ']'
++ hostname=10.0.1.12
++ shift
++ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- cat /sys/class/net/enp0s8/address
+ export SERVER_B_MAC=08:00:27:38:99:15
+ SERVER_B_MAC=08:00:27:38:99:15
+ arp -s 10.0.1.11 08:00:27:66:48:02
+ arp -s 10.0.1.12 08:00:27:38:99:15
+ arp -s 10.0.0.11 08:00:27:fe:18:fc
+ arp -s 10.0.0.12 08:00:27:72:8a:ae
++ get-ip enp0s8
++ iface=enp0s8
++ /sbin/ip -o -4 addr list enp0s8
++ awk '{print $4}'
++ cut -d/ -f1
+ IFACE_IP=10.0.0.1
++ get-ip enp0s9
++ iface=enp0s9
++ /sbin/ip -o -4 addr list enp0s9
++ awk '{print $4}'
++ cut -d/ -f1
+ REV_IFACE_IP=10.0.1.1
+ run-on-host 10.0.0.11 sudo ip route add 10.0.1.0/24 via 10.0.0.1
+ '[' 8 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo ip route add 10.0.1.0/24 via 10.0.0.1
RTNETLINK answers: File exists
+ run-on-host 10.0.0.12 sudo ip route add 10.0.1.0/24 via 10.0.0.1
+ '[' 8 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo ip route add 10.0.1.0/24 via 10.0.0.1
RTNETLINK answers: File exists
+ run-on-host 10.0.1.11 sudo ip route add 10.0.0.0/24 via 10.0.1.1
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo ip route add 10.0.0.0/24 via 10.0.1.1
RTNETLINK answers: File exists
+ run-on-host 10.0.1.12 sudo ip route add 10.0.0.0/24 via 10.0.1.1
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo ip route add 10.0.0.0/24 via 10.0.1.1
RTNETLINK answers: File exists
+ run-on-host 10.0.0.11 sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ '[' 13 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ run-on-host 10.0.0.12 sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ '[' 13 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ run-on-host 10.0.1.11 sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ '[' 13 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ run-on-host 10.0.1.12 sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ '[' 13 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo ethtool -K enp0s8 tso off gso off gro off tx off
+ config-nic enp0s8
+ NIC=enp0s8
+ ip link set enp0s8 mtu 1500
+ ethtool -K enp0s8 tso off gso off gro off tx off
+ sysctl net.ipv6.conf.enp0s8.disable_ipv6=1
net.ipv6.conf.enp0s8.disable_ipv6 = 1
+ config-nic enp0s9
+ NIC=enp0s9
+ ip link set enp0s9 mtu 1500
+ ethtool -K enp0s9 tso off gso off gro off tx off
+ sysctl net.ipv6.conf.enp0s9.disable_ipv6=1
net.ipv6.conf.enp0s9.disable_ipv6 = 1
+ sysctl -w net.ipv4.ip_forward=0
net.ipv4.ip_forward = 0
+ sysctl -w net.ipv4.tcp_ecn=0
net.ipv4.tcp_ecn = 0
+ ip link set enp0s10 mtu 2000
+ killall simple_switch
simple_switch: no process found
+ SIMPLE_SWITCH='/home/montimage/bertrand-behavioral-model/targets/simple_switch/simple_switch --queue 2  --ll_queue 64 --BE_queue 128'
+ DEBUG='--log-file log/sw.log  --log-level info --pcap log/'
+ DEBUG=
+ SW_PID=5359
+ renice -n -10 -p 5359
+ /home/montimage/bertrand-behavioral-model/targets/simple_switch/simple_switch --queue 2 --ll_queue 64 --BE_queue 128 -i 1@enp0s8 -i 2@enp0s9 -i 3@enp0s10 switch-l4s.json
5359 (process ID) old priority 0, new priority -10
+ taskset -c 0-4 -p 5359
taskset: failed to execute -p: No such file or directory
+ sleep 2
+ monitor_cpu_memory 5359
+ PID=5359
+ FILE_NAME=log/cpu_mem_int_yes_pid_5359
+ /home/montimage/.local/bin/psrecord 5359 --log log/cpu_mem_int_yes_pid_5359.txt --duration 320 --interval 1 --include-children
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: Setting default action of ipv4_lpm
action:              drop
runtime data:        
RuntimeCmd: Setting default action of ipv4_lpm
action:              drop
runtime data:        
RuntimeCmd: Adding entry to exact match table ipv4_lpm
match key:           EXACT-0a:00:00:0b
action:              ipv4_forward
runtime data:        08:00:27:55:c7:75	08:00:27:fe:18:fc	00:01
Entry has been added with handle 0
RuntimeCmd: Adding entry to exact match table ipv4_lpm
match key:           EXACT-0a:00:00:0c
action:              ipv4_forward
runtime data:        08:00:27:55:c7:75	08:00:27:72:8a:ae	00:01
Entry has been added with handle 1
RuntimeCmd: Adding entry to exact match table ipv4_lpm
match key:           EXACT-0a:00:01:0b
action:              ipv4_forward
runtime data:        08:00:27:32:3c:0d	08:00:27:66:48:02	00:02
Entry has been added with handle 2
RuntimeCmd: Adding entry to exact match table ipv4_lpm
match key:           EXACT-0a:00:01:0c
action:              ipv4_forward
runtime data:        08:00:27:32:3c:0d	08:00:27:38:99:15	00:02
Entry has been added with handle 3
RuntimeCmd: 
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: Adding entry to exact match table select_PI2_param
match key:           
action:              set_PI2_param
runtime data:        00:00:05:3e	00:00:34:6d	00:00:3a:98	0e
Entry has been added with handle 0
RuntimeCmd: Adding entry to exact match table select_L4S_param
match key:           
action:              set_L4S_param
runtime data:        00:00:13:88	00:00:0b:b8	00	00:00:05:dc	15
Entry has been added with handle 0
RuntimeCmd: 
+ [[ yes == \y\e\s ]]
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: Error: Invalid table name (tb_int_config_transit)
RuntimeCmd: 
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: Adding entry to ternary match table tb_int_config_source
match key:           TERNARY-0a:00:00:0b &&& ff:ff:00:00	TERNARY-13:89 &&& 00:00	TERNARY-0a:00:01:0b &&& ff:ff:00:00	TERNARY-13:89 &&& 00:00
action:              set_source
runtime data:        04	0a	ff:ff
Entry has been added with handle 0
RuntimeCmd: 
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: Error: Invalid table name (tb_int_config_sink)
RuntimeCmd: 
+ cat
+ config_sw
+ tee -a log/config.log
+ /usr/local/bin/simple_switch_CLI
Obtaining JSON from switch...
Done
Control utility for runtime P4 table manipulation
RuntimeCmd: RuntimeCmd: 
+ bash ./test-suites.sh
++ export IFACE=enp0s8
++ IFACE=enp0s8
++ export REV_IFACE=enp0s9
++ REV_IFACE=enp0s9
++ export MON_IFACE=enp0s10
++ MON_IFACE=enp0s10
++ export SERVER_NET=10.0.1.0/24
++ SERVER_NET=10.0.1.0/24
++ export CLIENT_NET=10.0.0.0/24
++ CLIENT_NET=10.0.0.0/24
++ export SERVER_A=10.0.1.11
++ SERVER_A=10.0.1.11
++ export SERVER_B=10.0.1.12
++ SERVER_B=10.0.1.12
++ export CLIENT_A=10.0.0.11
++ CLIENT_A=10.0.0.11
++ export CLIENT_B=10.0.0.12
++ CLIENT_B=10.0.0.12
++ export CLIENT_A_IFACE=enp0s8
++ CLIENT_A_IFACE=enp0s8
++ export CLIENT_B_IFACE=enp0s8
++ CLIENT_B_IFACE=enp0s8
++ export SERVER_A_IFACE=enp0s8
++ SERVER_A_IFACE=enp0s8
++ export SERVER_B_IFACE=enp0s8
++ SERVER_B_IFACE=enp0s8
++ export MMT_IP=10.0.30.2
++ MMT_IP=10.0.30.2
++ export MMT_IFACE=enp0s8
++ MMT_IFACE=enp0s8
+ DELAY=1ms
+ set -x
+ BW=4M
+ hn-test-l4s-int-secu-ia
+ DURATION=60
+ LL_BANDWIDTH=1M
+ CL_BANDWIDTH=0M
+ cat
+ hn-generate-traffic-iperf-traffic 60 1M 0M
+ sleep 60
+ bash measure--int-l4s-secu-ia/start-monitoring.sh
+ DURATION=60
+ LL_BANDWIDTH=1M
+ CL_BANDWIDTH=0M
+ hn-stop-all-test
+ run-on-all-endhost sudo killall -9 iperf3
+ MACHINES=($CLIENT_A $CLIENT_B $SERVER_A $SERVER_B)
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.11 sudo killall -9 iperf3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo killall -9 iperf3
Mon Jan 16 13:08:41 UTC 2023
+++ dirname measure--int-l4s-secu-ia/start-monitoring.sh
++ cd -- measure--int-l4s-secu-ia
++ pwd -P
+ SCRIPTPATH=/home/montimage/hipnet/measure--int-l4s-secu-ia
+ MMT_CONFIG_FILE=/home/montimage/hipnet/measure--int-l4s-secu-ia/mmt-probe.conf
++ cat
+ ATTRIBUTES='   "meta.packet_len",
   "ip.src", 
   "ip.dst", 
   "ip.proto_tos", 
   "ip.ecn",
   "ip.identification", 
   "tcp.src_port", 
   "tcp.dest_port",
   "tcp.seq_nb",
   "tcp.ack_nb",
   "tcp.tsval",
   "tcp.tsecr",
   "int.hop_queue_ids",
   "int.hop_latencies", 
   "int.hop_queue_occups",
   "int.hop_ingress_times", 
   "int.hop_egress_times",
   "int.hop_l4s_mark", 
   "int.hop_l4s_drop",
   "int.hop_tx_utilizes"'
++ cat
+ ATTRIBUTES_HEADERS='   "meta.packet_len",
   "ip.src", 
   "ip.dst", 
   "ip.proto_tos", 
   "ip.ecn",
   "ip.identification", 
   "tcp.src_port", 
   "tcp.dest_port",
   "tcp.seq_nb",
   "tcp.ack_nb",
   "tcp.tsval",
   "tcp.tsecr",
   "int.queue_id",
   "int.latency", 
   "int.queue_occups",
   "int.ingress_time", 
   "int.egress_time",
   "int.nb_marked", 
   "int.nb_dropped",
   "int.mark_probability"'
+ LOG_DIR=log
+ mkdir -- log
mkdir: cannot create directory ‘log’: File exists
+ monitor
+ cd -- log
+ cp -- /home/montimage/hipnet/measure--int-l4s-secu-ia/mmt-probe.conf ./mmt-probe.conf
+ generate-config
+ cat
++ date
+ echo 'Start pcap dump'
Start pcap dump
+ TCPDUMP_PID=5439
+ sleep 1
+ pcap-dump
+ sudo tcpdump -i enp0s8 -w data.pcap
iperf3: no process found
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.12 sudo killall -9 iperf3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo killall -9 iperf3
tcpdump: listening on enp0s8, link-type EN10MB (Ethernet), capture size 262144 bytes
iperf3: no process found
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.11 sudo killall -9 iperf3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo killall -9 iperf3
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.12 sudo killall -9 iperf3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo killall -9 iperf3
+ echo 'Start MMT'
Start MMT
+ sudo mmt-probe -c ./mmt-probe.conf -i enp0s10
mmt-probe: Must not run debug mode in production environment
mmt-probe: Loaded configuration from './mmt-probe.conf'
mmt-probe: MMT-Probe v1.5.5 (417daa7 - Nov 17 2022 10:34:49) is running on pid 5447
mmt-probe: Modules: DPI, PCAP, REPORT, SECURITY, debug
+ sleep 2
mmt-probe: MMT-DPI 1.7.3 (92ce3808)
mmt-probe: Starting PCAP mode to analyze 'enp0s10' using the main thread
+ run-on-all-endhost screen -XS hn quit
+ MACHINES=($CLIENT_A $CLIENT_B $SERVER_A $SERVER_B)
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.11 screen -XS hn quit
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- screen -XS hn quit
No screen session found.
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.12 screen -XS hn quit
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- screen -XS hn quit
No screen session found.
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.11 screen -XS hn quit
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- screen -XS hn quit
No screen session found.
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.12 screen -XS hn quit
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- screen -XS hn quit
No screen session found.
+ run-on-all-endhost sudo killall screen
+ MACHINES=($CLIENT_A $CLIENT_B $SERVER_A $SERVER_B)
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.11 sudo killall screen
+ '[' 4 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo killall screen
screen: no process found
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.0.12 sudo killall screen
+ '[' 4 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo killall screen
screen: no process found
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.11 sudo killall screen
+ '[' 4 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo killall screen
screen: no process found
+ for hostname in ${MACHINES[@]}
+ run-on-host 10.0.1.12 sudo killall screen
+ '[' 4 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo killall screen
screen: no process found
+ run-on-host 10.0.0.11 sudo tc qdisc del dev enp0s8 root
+ '[' 8 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo tc qdisc del dev enp0s8 root
RTNETLINK answers: No such file or directory
+ run-on-host 10.0.0.12 sudo tc qdisc del dev enp0s8 root
+ '[' 8 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo tc qdisc del dev enp0s8 root
RTNETLINK answers: No such file or directory
+ run-on-host 10.0.1.11 sudo tc qdisc del dev enp0s8 root
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo tc qdisc del dev enp0s8 root
RTNETLINK answers: No such file or directory
+ run-on-host 10.0.1.12 sudo tc qdisc del dev enp0s8 root
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo tc qdisc del dev enp0s8 root
RTNETLINK answers: No such file or directory
+ hn-setup-prague-cubic
+ run-on-host 10.0.0.11 sudo sysctl -w net.ipv4.tcp_congestion_control=prague
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo sysctl -w net.ipv4.tcp_congestion_control=prague
net.ipv4.tcp_congestion_control = prague
sysctl: setting key "net.ipv4.tcp_congestion_control": No such file or directory
DEBUG /home/montimage/mmt/mmt-probe/src/configure.c:127: security.ip-encapsulation-index = 16
DEBUG /home/montimage/mmt/mmt-probe/src/configure.c:988: Parsing block 'reconstruct-data ftp'
DEBUG /home/montimage/mmt/mmt-probe/src/configure.c:988: Parsing block 'reconstruct-data http'
DEBUG /home/montimage/mmt/mmt-probe/src/worker.c:168: Starting worker 0
1,3,"enp0s10",1673874523.521363,"1.5.5 (417daa7 - Nov 17 2022 10:34:49)","1.7.3 (92ce3808)","1.2.14 (d74aea4 - Nov 17 2022 10:33:31)"
200,3,"enp0s10",1673874528.703046,285,0,282,0,73709,0
mmt-probe: 285,0,282,0,73709,0% dropped by NIC 0.0000, by MMT 0.0000
285,0,282,0,73709,0% dropped by NIC 0.0000, by MMT 0.0000
+ run-on-host 10.0.1.11 sudo sysctl -w net.ipv4.tcp_congestion_control=prague
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo sysctl -w net.ipv4.tcp_congestion_control=prague
net.ipv4.tcp_congestion_control = prague
sysctl: setting key "net.ipv4.tcp_congestion_control": No such file or directory
+ run-on-host 10.0.0.11 sudo sysctl -w net.ipv4.tcp_ecn=3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- sudo sysctl -w net.ipv4.tcp_ecn=3
net.ipv4.tcp_ecn = 3
+ run-on-host 10.0.1.11 sudo sysctl -w net.ipv4.tcp_ecn=3
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- sudo sysctl -w net.ipv4.tcp_ecn=3
net.ipv4.tcp_ecn = 3
+ run-on-host 10.0.0.12 sudo sysctl -w net.ipv4.tcp_congestion_control=cubic
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo sysctl -w net.ipv4.tcp_congestion_control=cubic
net.ipv4.tcp_congestion_control = cubic
+ run-on-host 10.0.1.12 sudo sysctl -w net.ipv4.tcp_congestion_control=cubic
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo sysctl -w net.ipv4.tcp_congestion_control=cubic
net.ipv4.tcp_congestion_control = cubic
+ run-on-host 10.0.0.12 sudo sysctl -w net.ipv4.tcp_ecn=0
+ '[' 5 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- sudo sysctl -w net.ipv4.tcp_ecn=0
net.ipv4.tcp_ecn = 0
+ run-on-host 10.0.1.12 sudo sysctl -w net.ipv4.tcp_ecn=0
+ '[' 5 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- sudo sysctl -w net.ipv4.tcp_ecn=0
net.ipv4.tcp_ecn = 0
+ run-on-host 10.0.1.11 screen -S hn -dm iperf3 -s --one-off
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.11 -- screen -S hn -dm iperf3 -s --one-off
+ run-on-host 10.0.1.12 screen -S hn -dm iperf3 -s --one-off
+ '[' 8 -lt 2 ']'
+ hostname=10.0.1.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.1.12 -- screen -S hn -dm iperf3 -s --one-off
+ sleep 5
200,3,"enp0s10",1673874533.703967,494,0,494,0,127522,0
mmt-probe: 494,0,494,0,127522,0% dropped by NIC 0.0000, by MMT 0.0000
494,0,494,0,127522,0% dropped by NIC 0.0000, by MMT 0.0000
+ run-on-host 10.0.0.11 screen -S hn -dm iperf3 -c 10.0.1.11 --bandwidth 1M --set-mss 1400 --length 1400 --time 60
+ '[' 16 -lt 2 ']'
+ hostname=10.0.0.11
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.11 -- screen -S hn -dm iperf3 -c 10.0.1.11 --bandwidth 1M --set-mss 1400 --length 1400 --time 60
+ run-on-host 10.0.0.12 screen -S hn -dm iperf3 -c 10.0.1.12 --bandwidth 0M --set-mss 1400 --length 1400 --time 60
+ '[' 16 -lt 2 ']'
+ hostname=10.0.0.12
+ shift
+ ssh -i /home/montimage/.ssh/id_rsa montimage@10.0.0.12 -- screen -S hn -dm iperf3 -c 10.0.1.12 --bandwidth 0M --set-mss 1400 --length 1400 --time 60
+ echo 'generating traffic...'
generating traffic...
200,3,"enp0s10",1673874538.704173,7733,0,7711,0,9244154,0
mmt-probe: 7733,0,7711,0,9244154,0% dropped by NIC 0.0000, by MMT 0.0000
7733,0,7711,0,9244154,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874543.704236,26194,0,26159,0,33296786,0
mmt-probe: 26194,0,26159,0,33296786,0% dropped by NIC 0.0000, by MMT 0.0000
26194,0,26159,0,33296786,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874548.704642,43098,0,43039,0,55657734,0
mmt-probe: 43098,0,43039,0,55657734,0% dropped by NIC 0.0000, by MMT 0.0000
43098,0,43039,0,55657734,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874553.704686,59473,0,59448,0,77376848,0
mmt-probe: 59473,0,59448,0,77376848,0% dropped by NIC 0.0000, by MMT 0.0000
59473,0,59448,0,77376848,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874558.704775,77399,0,77358,0,101461824,0
mmt-probe: 77399,0,77358,0,101461824,0% dropped by NIC 0.0000, by MMT 0.0000
77399,0,77358,0,101461824,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874563.704854,95376,0,95332,0,125149500,0
mmt-probe: 95376,0,95332,0,125149500,0% dropped by NIC 0.0000, by MMT 0.0000
95376,0,95332,0,125149500,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874568.705104,115490,0,115468,0,152185124,0
mmt-probe: 115490,0,115468,0,152185124,0% dropped by NIC 0.0000, by MMT 0.0000
115490,0,115468,0,152185124,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874573.705106,136429,0,136370,0,180314852,0
mmt-probe: 136429,0,136370,0,180314852,0% dropped by NIC 0.0000, by MMT 0.0000
136429,0,136370,0,180314852,0% dropped by NIC 0.0000, by MMT 0.0000
200,3,"enp0s10",1673874578.705349,155148,0,155133,0,205142570,0
mmt-probe: 155148,0,155133,0,205142570,0% dropped by NIC 0.0000, by MMT 0.0000
155148,0,155133,0,205142570,0% dropped by NIC 0.0000, by MMT 0.0000
+ killall mmt-probe
+ killall tcpdump
208857 packets captured
209009 packets received by filter
0 packets dropped by kernel
+ sleep 20
measure--int-l4s-secu-ia/start-monitoring.sh: line 82:  5446 Terminated              sudo mmt-probe -c ./mmt-probe.conf -i enp0s10
+ sleep 5
+ echo Terminating..
Terminating..
+ killall tcpdump
tcpdump: no process found
+ tar -czf pcap.tar.gz data.pcap
+ sudo rm data.pcap
+ echo 'Processing output files ...'
Processing output files ...
++ echo 'report-id,probe-id,source,timestamp,report-name,packet_index,   "meta.packet_len",
   "ip.src", 
   "ip.dst", 
   "ip.proto_tos", 
   "ip.ecn",
   "ip.identification", 
   "tcp.src_port", 
   "tcp.dest_port",
   "tcp.seq_nb",
   "tcp.ack_nb",
   "tcp.tsval",
   "tcp.tsecr",
   "int.queue_id",
   "int.latency", 
   "int.queue_occups",
   "int.ingress_time", 
   "int.egress_time",
   "int.nb_marked", 
   "int.nb_dropped",
   "int.mark_probability"'
++ tr -d '"'
++ tr -d '\n'
++ tr -d ' '
+ HEADER=report-id,probe-id,source,timestamp,report-name,packet_index,meta.packet_len,ip.src,ip.dst,ip.proto_tos,ip.ecn,ip.identification,tcp.src_port,tcp.dest_port,tcp.seq_nb,tcp.ack_nb,tcp.tsval,tcp.tsecr,int.queue_id,int.latency,int.queue_occups,int.ingress_time,int.egress_time,int.nb_marked,int.nb_dropped,int.mark_probability
+ echo report-id,probe-id,source,timestamp,report-name,packet_index,meta.packet_len,ip.src,ip.dst,ip.proto_tos,ip.ecn,ip.identification,tcp.src_port,tcp.dest_port,tcp.seq_nb,tcp.ack_nb,tcp.tsval,tcp.tsecr,int.queue_id,int.latency,int.queue_occups,int.ingress_time,int.egress_time,int.nb_marked,int.nb_dropped,int.mark_probability
++ find . -name '1*.csv'
+ for f in $(find . -name '1*.csv')
+ echo ' ./1673874523.520865_0_data-int.csv'
 ./1673874523.520865_0_data-int.csv
+ grep '^1000,'
+ cat -- ./1673874523.520865_0_data-int.csv
+ sudo rm -- ./1673874523.520865_0_data-int.csv
+ date
Mon Jan 16 13:09:50 UTC 2023
+ echo Bye
Bye
+ echo byebye
byebye
+ killall -2 simple_switch
+ sleep 2
Attaching to process 5359
Process finished (83.16 seconds)
+ echo exit....
exit....
+ exit 0
+ killall -2 simple_switch
simple_switch: no process found
+ sleep 2
